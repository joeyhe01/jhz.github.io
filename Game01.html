<html>
    <head>
        <title>Ultimate Tic Tac Toe!</title>
        <script src="jquery-3.2.1.min.js"></script>
        
        <style type="text/css">
            .container {
                padding-left: 100px;
                padding-top: 30px;
                width: 456px;
                height: 456px;
            }
            
            .container-small {
                border: 1px solid black;
                width: 150px;
                height: 150px;
                float: left;
            }
            
            .box {
                width: 50px;
                height: 50px;
                float: left;
                font-size: 40px;
                text-align: center;
                font-family: Helvetica;
            }
            
            .box:hover {
                cursor: pointer;
            }
            
            /*.container-small:hover {
                background-color: lightgreen;
            }*/
            
            ul{
                font-family: Helvetica;     
                margin:20px;
            }
            li{
                margin-top: 10px;
            }
            .divRule{
                font-family: Helvetica;     
                font-size: 16px;
                font-weight: bold;
            }
         
            
        </style>
    </head>
    
    <body>
        <div class='divRule'>Ultimate Tic Tac Toe Rules</div>
        <ul>
           <li>Each small 3-by-3 tic-tac-toe board is referred to as a local board, and the larger 3-by-3 board is referred to as the global board.</li>
            <li>
            The game starts with X playing wherever he wants in any of the 81 empty spots. This move 'sends' his opponent to its relative location. For example, if X played in the middle of his local board, then O needs to play next in the local board in the middle of the global board. O can then play in any one of the nine available spots in the top-right local board, each move sending X to a different local board.
            </li>
            <li>
            If a move is played so that it is to win a local board by the rules of normal tic-tac-toe, then it wins that local board.
            </li>
            <li>
            Once the outcome of a local board is decided (win or draw), no more moves may be played in that board. If a player is sent to such a board, then that player may play in any other board.
            </li>
            <li>Game play ends when either a player wins the global board, or there are no legal moves remaining
            </li> 
        </ul>
        <div class="container">
            <div class="container-small" id="1">
                <div class="box" id="11"></div>
                <div class="box" id="12"></div>
                <div class="box" id="13"></div>
                <div class="box" id="14"></div>
                <div class="box" id="15"></div>
                <div class="box" id="16"></div>
                <div class="box" id="17"></div>
                <div class="box" id="18"></div>
                <div class="box" id="19"></div>
            </div>
            <div class="container-small" id="2">
                <div class="box" id="21"></div>
                <div class="box" id="22"></div>
                <div class="box" id="23"></div>
                <div class="box" id="24"></div>
                <div class="box" id="25"></div>
                <div class="box" id="26"></div>
                <div class="box" id="27"></div>
                <div class="box" id="28"></div>
                <div class="box" id="29"></div>
            </div>
            <div class="container-small" id="3">
                <div class="box" id="31"></div>
                <div class="box" id="32"></div>
                <div class="box" id="33"></div>
                <div class="box" id="34"></div>
                <div class="box" id="35"></div>
                <div class="box" id="36"></div>
                <div class="box" id="37"></div>
                <div class="box" id="38"></div>
                <div class="box" id="39"></div>
            </div>
            <div class="container-small" id="4">
                <div class="box" id="41"></div>
                <div class="box" id="42"></div>
                <div class="box" id="43"></div>
                <div class="box" id="44"></div>
                <div class="box" id="45"></div>
                <div class="box" id="46"></div>
                <div class="box" id="47"></div>
                <div class="box" id="48"></div>
                <div class="box" id="49"></div>
            </div>
            <div class="container-small" id="5">
                <div class="box" id="51"></div>
                <div class="box" id="52"></div>
                <div class="box" id="53"></div>
                <div class="box" id="54"></div>
                <div class="box" id="55"></div>
                <div class="box" id="56"></div>
                <div class="box" id="57"></div>
                <div class="box" id="58"></div>
                <div class="box" id="59"></div>
            </div>
            <div class="container-small" id="6">
                <div class="box" id="61"></div>
                <div class="box" id="62"></div>
                <div class="box" id="63"></div>
                <div class="box" id="64"></div>
                <div class="box" id="65"></div>
                <div class="box" id="66"></div>
                <div class="box" id="67"></div>
                <div class="box" id="68"></div>
                <div class="box" id="69"></div>
            </div>
            <div class="container-small" id="7">
                <div class="box" id="71"></div>
                <div class="box" id="72"></div>
                <div class="box" id="73"></div>
                <div class="box" id="74"></div>
                <div class="box" id="75"></div>
                <div class="box" id="76"></div>
                <div class="box" id="77"></div>
                <div class="box" id="78"></div>
                <div class="box" id="79"></div>
            </div>
            <div class="container-small" id="8">
                <div class="box" id="81"></div>
                <div class="box" id="82"></div>
                <div class="box" id="83"></div>
                <div class="box" id="84"></div>
                <div class="box" id="85"></div>
                <div class="box" id="86"></div>
                <div class="box" id="87"></div>
                <div class="box" id="88"></div>
                <div class="box" id="89"></div>
            </div>
            <div class="container-small" id="9">
                <div class="box" id="91"></div>
                <div class="box" id="92"></div>
                <div class="box" id="93"></div>
                <div class="box" id="94"></div>
                <div class="box" id="95"></div>
                <div class="box" id="96"></div>
                <div class="box" id="97"></div>
                <div class="box" id="98"></div>
                <div class="box" id="99"></div>
            </div>
            
        </div>
        <br>
        <br>
        
        <a href="bbc.html" style="font-family: Helvetica; padding-left: 30px">Return To Home</a>
        
        <script type="text/javascript">
            
       
            var myArray = new Array(99);
            for(var i = 11; i <= 99; i++) {
                if(i % 10 != 0) {
                    myArray[i] = 0;
                }
            }
            
            var myArray2 = new Array(9);
            for(var i = 0; i < 9; i++) {
                myArray2[i] = true;
            }
            
            var currentMove = 0; 
            var currentSquare = -1; 
            updateTable();
            
            for(var i = 11; i <= 99; i++) {
                if(i % 10 != 0) {
                    $("#" + i).click(function() {
                        if(myArray[$(this).attr("id")] == 0) {
                            
                            var gate = true; //The gate. If the gate is false, that means the user has played on a square that has already been won (therefore giving the other player a free move).
                            var numSquare = (parseInt($(this).attr("id")) % 10) - 1; //The small square's index that was clicked
                            var clickedGrid = Math.floor($(this).attr("id")/10) - 1; //The grid that was clicked
                            if(hasWon(numSquare + 1)) {
                                gate = false;
                            }
                            
                            if(!myArray2[clickedGrid]) { //This array handles where the user can or cannot go. Hence, it "returns", meaning it ends the execution of this function.
                                return;
                            }
                            
                            if(currentMove % 2 == 0) { //This logic controls whether an X or an O goes on which square. It updates myArray, the array that controls each individual square.
                                myArray[$(this).attr("id")] = 1;
                            } else {
                                myArray[$(this).attr("id")] = 2;
                            }
                            currentMove += 1;
                            
                            if(hasWon(currentSquare + 1) && numSquare == clickedGrid) { //Checks for if the player clicked on an already won square.
                               gate = false;
                            }
                            
                            if(currentMove != 0 && gate) { //Sets myArray2 so that only the grid that relates to the square is available to click on. Note that these conditions are skipped if the gate is false, since that's a special case.
                                for(var i = 0; i < 9; i++) {
                                    if(i != numSquare) {
                                        myArray2[i] = false;
                                    } else {
                                        myArray2[i] = true;
                                        currentSquare = i;
                                    }
                                }
                            }
                            
                            if(!gate) { //Handles logic for if the player goes on a square that's already won (when the gate is false).
                                for(var i = 0; i < 9; i++) {
                                    if(!hasWon(i + 1)) {
                                        myArray2[i] = true;
                                    } else {
                                        myArray2[i] = false;
                                    }
                                }
                            }
                            
                            gate = true;
                        }
                        
                        if(hasWonGame() == 1) { //Testing for if the entire game has been won
                            for(var i = 0; i < 9; i++) {
                                myArray2[i] = false;
                                alert("Player 1 wins.");
                            }
                        }
                        else if(hasWonGame() == 2) {
                            for(var i = 9; i < 9; i++) {
                                myArray2[i] = false;
                                alert("Player 2 wins.");
                            }
                        }
                        
                        updateTable();
                    });
                    
                    
                    
                    $("#" + i).hover(function() { //Handles the graphics, or the colors, that appear as the divs are hovered over
                        if(myArray[$(this).attr("id")] != 0) {
                            $("#" + $(this).attr("id")).css("backgroundColor", "lightcoral");
                        } else {
                            $("#" + $(this).attr("id")).css("backgroundColor", "azure");
                        }
                    }, function() {
                        $("#" + $(this).attr("id")).css("backgroundColor", "transparent");
                    });
                }
            }
            
            
            
            
            
            function updateTable() { //Updates the visuals of the table. Takes the arrays that have been manipulated above and translates that into visuals, colors, and text.
                for(var i = 11; i <= 99; i++) {
                    if(i % 10 != 0) {
                        if(myArray[i] == 1) {
                            $("#" + i).html("X");
                        } else if(myArray[i] == 2) {
                            $("#" + i).html("O");
                        }
                        
                    }
                }
                for(var i = 0; i < 9; i++) { //Handles square winning graphics and hover graphics for each grid
                    var won = hasWon(i+1);
                    
                    if(myArray2[i] && currentMove != 0) {
                        $("#" + (i+1)).hover(function() {
                            $("#" + $(this).attr("id")).css("backgroundColor", "lightgreen");
                        }, function() {
                            $("#" + $(this).attr("id")).css("backgroundColor", "transparent");
                        });
                    } else if(!myArray2[i] && currentMove != 0) {
                        $("#" + (i+1)).hover(function() {
                            $("#" + $(this).attr("id")).css("backgroundColor", "darksalmon");
                        }, function() {
                            $("#" + $(this).attr("id")).css("backgroundColor", "transparent");
                        });
                    } else if(currentMove == 0) {
                        $("#" + (i+1)).hover(function() {
                            $("#" + $(this).attr("id")).css("backgroundColor", "lightgreen");
                        }, function() {
                            $("#" + $(this).attr("id")).css("backgroundColor", "transparent");
                        });
                    }
                    
                    if(won == 1) {
                        $("#" + (i+1)).css("backgroundColor", "bisque");
                        $("#" + (i+1)).hover(function() {
                            $("#" + $(this).attr("id")).css("backgroundColor", "bisque");
                        }, function() {
                            $("#" + $(this).attr("id")).css("backgroundColor", "bisque");
                        });
                    }
                    if(won == 2) {
                        $("#" + (i+1)).css("backgroundColor", "lightblue");
                        $("#" + (i+1)).hover(function() {
                            $("#" + $(this).attr("id")).css("backgroundColor", "lightblue");
                        }, function() {
                            $("#" + $(this).attr("id")).css("backgroundColor", "lightblue");
                        });
                    }
                }
            }
            
            function hasWon(square) { //Outputs whether or not a player has won a specific grid, and specifies which player
                var ids = new Array(9);
                for(var i = 0; i < 9; i++) {
                    ids[i] = (square*10) + i + 1;
                }
                
                if((myArray[ids[0]] == 1 && myArray[ids[1]] == 1 && myArray[ids[2]] == 1) || (myArray[ids[3]] == 1 && myArray[ids[4]] == 1 && myArray[ids[5]] == 1) || (myArray[ids[6]] == 1 && myArray[ids[7]] == 1 && myArray[ids[8]] == 1) || (myArray[ids[0]] == 1 && myArray[ids[3]] == 1 && myArray[ids[6]] == 1) || (myArray[ids[1]] == 1 && myArray[ids[4]] == 1 && myArray[ids[7]] == 1) || (myArray[ids[3]] == 1 && myArray[ids[5]] == 1 && myArray[ids[8]] == 1) || (myArray[ids[0]] == 1 && myArray[ids[4]] == 1 && myArray[ids[8]] == 1) || (myArray[ids[2]] == 1 && myArray[ids[4]] == 1 && myArray[ids[6]] == 1)) {
                    return 1;
                } else if((myArray[ids[0]] == 2 && myArray[ids[1]] == 2 && myArray[ids[2]] == 2) || (myArray[ids[3]] == 2 && myArray[ids[4]] == 2 && myArray[ids[5]] == 2) || (myArray[ids[6]] == 2 && myArray[ids[7]] == 2 && myArray[ids[8]] == 2) || (myArray[ids[0]] == 2 && myArray[ids[3]] == 2 && myArray[ids[6]] == 2) || (myArray[ids[1]] == 2 && myArray[ids[4]] == 2 && myArray[ids[7]] == 2) || (myArray[ids[3]] == 2 && myArray[ids[5]] == 2 && myArray[ids[8]] == 2) || (myArray[ids[0]] == 2 && myArray[ids[4]] == 2 && myArray[ids[8]] == 2) || (myArray[ids[2]] == 2 && myArray[ids[4]] == 2 && myArray[ids[6]] == 2)) {
                    return 2;
                } else {
                    return 0;
                }
            }
            
            function hasWonGame() { //Outputs which player won the entire game
                var winBoard = new Array(9);
                for(var i = 1; i <= 9; i++) {
                    winBoard[i-1] = hasWon(i);
                }
                
                if((winBoard[0] == 1 && winBoard[1] == 1 && winBoard[2] == 1) || (winBoard[3] == 1 && winBoard[4] == 1 && winBoard[5] == 1) || (winBoard[6] == 1 && winBoard[7] == 1 && winBoard[8] == 1) || (winBoard[0] == 1 && winBoard[3] == 1 && winBoard[6] == 1) || (winBoard[1] == 1 && winBoard[4] == 1 && winBoard[7] == 1) || (winBoard[3] == 1 && winBoard[5] == 1 && winBoard[8] == 1) || (winBoard[0] == 1 && winBoard[4] == 1 && winBoard[8] == 1) || (winBoard[2] == 1 && winBoard[4] == 1 && winBoard[4] == 1)) {
                    return 1;
                } else if((winBoard[0] == 2 && winBoard[1] == 2 && winBoard[2] == 2) || (winBoard[3] == 2 && winBoard[4] == 2 && winBoard[5] == 2) || (winBoard[6] == 2 && winBoard[7] == 2 && winBoard[8] == 2) || (winBoard[0] == 2 && winBoard[3] == 2 && winBoard[6] == 2) || (winBoard[1] == 2 && winBoard[4] == 2 && winBoard[7] == 2) || (winBoard[3] == 2 && winBoard[5] == 2 && winBoard[8] == 2) || (winBoard[0] == 2 && winBoard[4] == 2 && winBoard[8] == 2) || (winBoard[2] == 2 && winBoard[4] == 2 && winBoard[4] == 2)) {
                    return 2;
                } else {
                    return 0;
                }
            }
        </script>
    </body>
</html>